<!-- app/views/conversations/_pending_requests.html.erb -->

<!-- This partial lists all pending conversation requests for the current_user as receiver -->
<% pending = current_user.conversations.where(receiver_id: current_user.id, status: "pending") %>

<% if pending.any? %>
  <ul>
    <% pending.each do |conv| %>
      <li>
        <strong>Request from:</strong> <%= conv.sender.profile.name %>
        <!-- Accept button -->
        <%= button_to "Accept",
              conversation_path(conv, status: "accepted"),
              method: :patch,
              class: "btn btn-success btn-sm",
              data: { turbo_stream: true, turbo_confirm: "Accept this conversation?" } %>
        <!-- Decline button -->
        <%= button_to "Decline",
              conversation_path(conv, status: "declined"),
              method: :patch,
              class: "btn btn-danger btn-sm",
              data: { turbo_stream: true, turbo_confirm: "Decline this conversation?" } %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p>No pending requests.</p>
<% end %>
